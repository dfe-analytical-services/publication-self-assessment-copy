library(shiny)
library(shinyjs)
#library(shinysky)
library(DT)
library(data.table)
library(lubridate)
library(shinyalert)
library(shinyWidgets)

start_data <- readRDS("new_tracker_data.rds")



rag_it <- function(label_text, input_id){
  
  div(
    class = "row",
    div(
      class = "col-sm-6",
      label_text,
    ),
    div(
      class = "col-sm-6",
      prettyRadioButtons(
        inputId = input_id,
        label = NULL,
        choices = c("Red", "Amber", "Green"),
        selected = "Amber",
        status = "primary",
        shape = "curve",
        animation = "pulse",
        bigger = TRUE,
        inline = TRUE
      ))
  )
  
}

# x<- data.frame(v1 = NA,
#                v2 = NA
#                
# )


# second try


# input_data <- data.frame(Brand = c("Brand1", "Brand2","Brand3"),
#                          ratio = c (.5, .5, .5),
#                          cost = c(2000, 3000, 4000),
#                          stringsAsFactors = FALSE) %>% 
#   mutate(updated_price = cost * ratio)


# Frist attempt

# 
# DateRecorded <- dmy(c("10/07/2018", "11/07/2018", "13/07/2018"))
# Value <- c(1, 2, 3)
# Person <- c("Bob", "Amy", "Charlotte")
# 
# df <- data.frame(DateRecorded, Value, Person)




# # Max file size ---------------------------------------------------------------------------------
# 
# options(shiny.maxRequestSize = 150 * 1024^2)
# 
# # Library calls ---------------------------------------------------------------------------------
# 
# library(shiny)
# library(janitor)
# library(dplyr)
# library(stringr)
# library(data.table)
# library(shinyjs)
# library(tools)
# library(readr)
# library(testthat)
# library(shinytest)
# 
# # activeTestsInFile ---------------------------------------------------------------------------------
# # Extracting the active tests that are run against files
# 
# activeTestsInFile <- function(file) {
#   trimws(gsub("\\(.* # active test", "", grep("(# active test)$", read_lines(file), value = TRUE)))
# }
# 
# activeTests <- sapply(c("R/fileValidation.r", "R/preCheck1.r", "R/preCheck2.r", "R/mainTests.r"), activeTestsInFile, simplify = FALSE)
# 
# numberActiveTests <- length(unlist(activeTests, use.names = FALSE))
# 
# # Function scripts ---------------------------------------------------------------------------------
# 
# source("R/knownVariables.r", encoding = "UTF-8")
# source("R/readFile.r")
# source("R/screenFiles.r")
# 
# # present_file_size ---------------------------------------------------------------------------------
# # Function to show the file size
# 
# present_file_size <- function(filesize) {
#   if (is.null(filesize)) {} else {
#     if (round(filesize / 1024 / 1024 / 1024, 2) >= 1) {
#       return(paste0(round(filesize / 1024 / 1024 / 1024, 2), " GB"))
#     } else {
#       if (round(filesize / 1024 / 1024, 2) < 1) {
#         return(paste0(round(filesize / 1024, 2), " Bytes"))
#       } else {
#         return(paste0(round(filesize / 1024 / 1024, 2), " MB"))
#       }
#     }
#   }
# }
# 
# # Results boxes ----------------------------------------------------------------------------
# 
# pass_results_box <- function() {
#   div(
#     div(
#       class = "panel panel-success",
#       div(
#         class = "panel-heading",
#         style = "color: white;font-size: 18px;font-style: bold;", # background-color: #70ad47;
#         "All the screener checks passed!"
#       ),
#       div(
#         class = "panel-body",
#         style = "padding-left:27px",
#         "Your files can now be uploaded to Explore Education Statistics, see our  ",
#         a(href = "https://rsconnect/rsc/stats-production-guidance/ees.html", "guidance on using EES", target = "_blank"),
#         " for more information."
#       )
#     )
#   )
# }
# 
# fail_results_box <- function(message, table) {
#   div(
#     div(
#       class = "panel panel-danger",
#       div(
#         class = "panel-heading",
#         style = "color: white;font-size: 18px;font-style: bold;", # background-color: #d45859;
#         textOutput(message)
#       ),
#       div(
#         class = "panel-body",
#         tableOutput(table)
#       )
#     )
#   )
# }
# 
# advisory_results_box <- function(message, table) {
#   div(
#     div(
#       class = "panel panel-warning",
#       div(
#         class = "panel-heading",
#         style = "color: white;font-size: 18px;font-style: bold; ", # background-color: #e87421;
#         textOutput(message)
#       ),
#       div(
#         class = "panel-body",
#         tableOutput(table)
#       )
#     )
#   )
# }
# 
# results_box <- function(message, table) {
#   div(
#     div(
#       class = "panel panel-secondary",
#       div(
#         class = "panel-heading",
#         style = "background-color: #727477; color: white;font-size: 18px; height:47px; vertical-align: middle; line-height:47px; padding-top:0px",
#         div(
#           class = "row",
#           div(
#             class = "col-sm-9",
#             textOutput(message)
#           ),
#           div(
#             class = "col-sm-3",
#             downloadButton("download_results", "Download results")
#           )
#         )
#       ),
#       div(
#         class = "panel-body",
#         tableOutput(table)
#       )
#     )
#   )
# }
# 
# ancillary_box <- function() {
#   div(
#     div(
#       class = "panel panel-info",
#       div(
#         class = "panel-heading",
#         style = "color: white;font-size: 18px;font-style: bold;", # background-color: #38a1c1;
#         "This file should not be uploaded as a standard data file"
#       ),
#       div(
#         class = "panel-body",
#         style = "padding-left:27px",
#         "The data file only includes geographic levels that are going to be ignored by EES, see our  ",
#         a(href = "https://rsconnect/rsc/stats-production-guidance/ees.html", "guidance on uploading ancillary files", target = "_blank"),
#         " for more information on how to upload as an ancillary file instead of via the normal data route."
#       )
#     )
#   )
# }
# 
# # cs_num ----------------------------------------------------------------------------
# # Comma separating function
# 
# cs_num <- function(value) {
#   format(value, big.mark = ",", trim = TRUE)
# }
# 
# # summarise_stats ----------------------------------------------------------------------------
# # Summarising the counts of the results
# 
# summarise_stats <- function(count, text) {
#   if (count == 1) {
#     paste0(count, " test ", text)
#   } else {
#     paste0(count, " tests ", text)
#   }
# }
# 
# # appLoadingCSS ----------------------------------------------------------------------------
# # Set up loading screen
# 
# appLoadingCSS <- "
# #loading-content {
#   position: absolute;
#   background: #000000;
#   opacity: 0.9;
#   z-index: 100;
#   left: 0;
#   right: 0;
#   height: 100%;
#   text-align: center;
#   color: #FFFFFF;
# }
# "
